from __future__ import absolute_importimport rakeimport requestsimport jsonstoppath = "magic/SmartStoplist.txt"def extract_keywords(text):	# Each word has min  X characters, 	# Each phrase atmost X words	# Each keyword appears atleast X times	text = text.replace("\n", " ")	rake_object = rake.Rake(stoppath, min_char_length=3, max_words_length=3, min_keyword_frequency=4,                 min_words_length_adj=1, max_words_length_adj=1, min_phrase_freq_adj=2) #  originally set to 5,3,4	keywords_with_scores = rake_object.run(text)	keywords = [item[0] for item in keywords_with_scores]	#keywords = [s.encode("ascii", "ignore") for s in keywords]	return keywordsdef get_images_from_unsplash(keyword):	client_id = "38d91223e00315d4c6926c55580e4e8c2ea513672893c1bdda4b3cbca4a09f31"	client_secret = "64efe5a0ee03d7bb161c111c6fc7e18b5d73e184d7ffe4294f09b3dbc099374b"		# api-endpoint 	URL = "https://api.unsplash.com/search/photos/"	# params given here 	print "keyword is ", keyword	query_param = keyword	query_page = "1"	query_per_page = "5"	query_orientation = "landscape"	PARAMS = {'query':query_param, 'page':query_page, 'per_page':query_per_page, 'orientation':query_orientation, 'client_id':client_id}	# sending get request and saving the response as response object 	r = requests.get(url = URL, params = PARAMS)	# extracting data in json format 	data = r.json()	l = len(data['results'])	dicts = []	for i in range(l):		d = {}		d['id'] = data['results'][i]['id']		d['description'] = data['results'][i]['description']		d['thumb'] = data['results'][i]['urls']['thumb']		d['regular'] = data['results'][i]['urls']['regular']		d['links'] = {}		if 'links' in data['results'][i]['user'] and 'html' in data['results'][i]['user']['links']:			d['links']['html'] = data['results'][i]['links']['html']		d['user'] = {}		if 'username' in data['results'][i]['user']:			d['user']['username'] = data['results'][i]['user']['username']		if 'portfolio_url' in data['results'][i]['user']:			d['user']['portfolio_url'] = data['results'][i]['user']['portfolio_url']		#json_d = json.dumps(d)		dicts.append(d)	return dictsdef text2images(text):	keywords = extract_keywords(text)	print "keywords are:", keywords	images = {}	images['images'] = []	images_dedup = {}	images_dedup['images'] = []	for keyword in keywords:		dicts = get_images_from_unsplash(keyword)		# FIX: Do not repeat images across keyword search		images['images'] += dicts		for image in images['images']:			if image not in images_dedup['images']:				images_dedup['images'].append(image)		if len(images_dedup['images']) >= 15:			break	#self.wfile.write("<html><body><h1>"+ '@'.join(keywords) +"</h1></body></html>")	print "total images", len(images_dedup['images'])	# convert images to json	return images_dedup